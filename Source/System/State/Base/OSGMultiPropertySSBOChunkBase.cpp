/*---------------------------------------------------------------------------*\
 *                                OpenSG                                     *
 *                                                                           *
 *                                                                           *
 *               Copyright (C) 2000-2013 by the OpenSG Forum                 *
 *                                                                           *
 *                            www.opensg.org                                 *
 *                                                                           *
 * contact: dirk@opensg.org, gerrit.voss@vossg.org, carsten_neumann@gmx.net  *
 *                                                                           *
\*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*\
 *                                License                                    *
 *                                                                           *
 * This library is free software; you can redistribute it and/or modify it   *
 * under the terms of the GNU Library General Public License as published    *
 * by the Free Software Foundation, version 2.                               *
 *                                                                           *
 * This library is distributed in the hope that it will be useful, but       *
 * WITHOUT ANY WARRANTY; without even the implied warranty of                *
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU         *
 * Library General Public License for more details.                          *
 *                                                                           *
 * You should have received a copy of the GNU Library General Public         *
 * License along with this library; if not, write to the Free Software       *
 * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.                 *
 *                                                                           *
\*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*\
 *                                Changes                                    *
 *                                                                           *
 *                                                                           *
 *                                                                           *
 *                                                                           *
 *                                                                           *
 *                                                                           *
\*---------------------------------------------------------------------------*/

/*****************************************************************************\
 *****************************************************************************
 **                                                                         **
 **                  This file is automatically generated.                  **
 **                                                                         **
 **          Any changes made to this file WILL be lost when it is          **
 **           regenerated, which can become necessary at any time.          **
 **                                                                         **
 **     Do not change this file, changes should be done in the derived      **
 **     class MultiPropertySSBOChunk!
 **                                                                         **
 *****************************************************************************
\*****************************************************************************/

#include <cstdlib>
#include <cstdio>

#ifdef WIN32 
#pragma warning(disable: 4355) // turn off 'this' : used in base member initializer list warning
#pragma warning(disable: 4290) // disable exception specification warning
#endif

#include "OSGConfig.h"




#include "OSGMultiPropertySSBOChunkBase.h"
#include "OSGMultiPropertySSBOChunk.h"

#include <boost/bind.hpp>

OSG_BEGIN_NAMESPACE

/***************************************************************************\
 *                            Description                                  *
\***************************************************************************/

/*! \class OSG::MultiPropertySSBOChunk
    See \ref PageSystemMultiPropertySSBOChunk for a description.

    The multi property chunk allows you to easily set up a shader storage block array with a simple 
    plain struct layout in std430 buffer format.

    This chunk is basically a specialization of the ShaderStorageBufferObjStdLayoutChunk with a simpler 
    usage pattern but at the cost of handling only a subset of the structural possibilities that the 
    general chunk allows.

    It can for instance be perfectly used to define material databases. See the example 'multirangelight'
    in the simple example folder for an application of this chunk.
 */

/***************************************************************************\
 *                        Field Documentation                              *
\***************************************************************************/

/*! \var UInt8           MultiPropertySSBOChunkBase::_mfTypes
    Stores the type of a block entry. This can be any of the set {FLOAT_T, DOUBLE_T, INT_T, UINT_T, BOOL_T, VEC3_T, VEC4_T, MAT4_T}.
*/

/*! \var UInt32          MultiPropertySSBOChunkBase::_mfCardinality
    Stores the cardinality types, i.e. the consecutive block layout members.
*/

/*! \var UInt32          MultiPropertySSBOChunkBase::_mfCardinalities
    Stores the accumulated cardinalities for each type.
*/

/*! \var UInt32          MultiPropertySSBOChunkBase::_sfNumProperties
    Stores the number of properties added to the chunk.
*/

/*! \var Real32          MultiPropertySSBOChunkBase::_mfFloatValues
    The float values.
*/

/*! \var Real64          MultiPropertySSBOChunkBase::_mfDoubleValues
    The double values.
*/

/*! \var Int32           MultiPropertySSBOChunkBase::_mfIntValues
    The int values.
*/

/*! \var UInt32          MultiPropertySSBOChunkBase::_mfUIntValues
    The unsigned int values.
*/

/*! \var bool            MultiPropertySSBOChunkBase::_mfBoolValues
    The bool values.
*/

/*! \var Vec3f           MultiPropertySSBOChunkBase::_mfVec3Values
    The 3D float vectors.
*/

/*! \var Vec4f           MultiPropertySSBOChunkBase::_mfVec4Values
    The 4D float vectors.
*/

/*! \var Matrix          MultiPropertySSBOChunkBase::_mfMatrixValues
    The matrices.
*/


/***************************************************************************\
 *                      FieldType/FieldTrait Instantiation                 *
\***************************************************************************/

#if !defined(OSG_DO_DOC) || defined(OSG_DOC_DEV)
PointerType FieldTraits<MultiPropertySSBOChunk *, nsOSG>::_type(
    "MultiPropertySSBOChunkPtr", 
    "ShaderStorageBufferObjStdLayoutChunkPtr", 
    MultiPropertySSBOChunk::getClassType(),
    nsOSG);
#endif

OSG_FIELDTRAITS_GETTYPE_NS(MultiPropertySSBOChunk *, nsOSG)

OSG_EXPORT_PTR_SFIELD_FULL(PointerSField,
                           MultiPropertySSBOChunk *,
                           nsOSG)

OSG_EXPORT_PTR_MFIELD_FULL(PointerMField,
                           MultiPropertySSBOChunk *,
                           nsOSG)

/***************************************************************************\
 *                         Field Description                               *
\***************************************************************************/

void MultiPropertySSBOChunkBase::classDescInserter(TypeObject &oType)
{
    FieldDescriptionBase *pDesc = NULL;


    pDesc = new MFUInt8::Description(
        MFUInt8::getClassType(),
        "types",
        "Stores the type of a block entry. This can be any of the set {FLOAT_T, DOUBLE_T, INT_T, UINT_T, BOOL_T, VEC3_T, VEC4_T, MAT4_T}.\n",
        TypesFieldId, TypesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleTypes),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleTypes));

    oType.addInitialDesc(pDesc);

    pDesc = new MFUInt32::Description(
        MFUInt32::getClassType(),
        "cardinality",
        "Stores the cardinality types, i.e. the consecutive block layout members.\n",
        CardinalityFieldId, CardinalityFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleCardinality),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleCardinality));

    oType.addInitialDesc(pDesc);

    pDesc = new MFUInt32::Description(
        MFUInt32::getClassType(),
        "cardinalities",
        "Stores the accumulated cardinalities for each type.\n",
        CardinalitiesFieldId, CardinalitiesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleCardinalities),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleCardinalities));

    oType.addInitialDesc(pDesc);

    pDesc = new SFUInt32::Description(
        SFUInt32::getClassType(),
        "numProperties",
        "Stores the number of properties added to the chunk.\n",
        NumPropertiesFieldId, NumPropertiesFieldMask,
        false,
        (Field::SFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleNumProperties),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleNumProperties));

    oType.addInitialDesc(pDesc);

    pDesc = new MFReal32::Description(
        MFReal32::getClassType(),
        "floatValues",
        "The float values.\n",
        FloatValuesFieldId, FloatValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleFloatValues),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleFloatValues));

    oType.addInitialDesc(pDesc);

    pDesc = new MFReal64::Description(
        MFReal64::getClassType(),
        "doubleValues",
        "The double values.\n",
        DoubleValuesFieldId, DoubleValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleDoubleValues),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleDoubleValues));

    oType.addInitialDesc(pDesc);

    pDesc = new MFInt32::Description(
        MFInt32::getClassType(),
        "intValues",
        "The int values.\n",
        IntValuesFieldId, IntValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleIntValues),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleIntValues));

    oType.addInitialDesc(pDesc);

    pDesc = new MFUInt32::Description(
        MFUInt32::getClassType(),
        "uIntValues",
        "The unsigned int values.\n",
        UIntValuesFieldId, UIntValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleUIntValues),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleUIntValues));

    oType.addInitialDesc(pDesc);

    pDesc = new MFBool::Description(
        MFBool::getClassType(),
        "boolValues",
        "The bool values.\n",
        BoolValuesFieldId, BoolValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleBoolValues),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleBoolValues));

    oType.addInitialDesc(pDesc);

    pDesc = new MFVec3f::Description(
        MFVec3f::getClassType(),
        "vec3Values",
        "The 3D float vectors.\n",
        Vec3ValuesFieldId, Vec3ValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleVec3Values),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleVec3Values));

    oType.addInitialDesc(pDesc);

    pDesc = new MFVec4f::Description(
        MFVec4f::getClassType(),
        "vec4Values",
        "The 4D float vectors.\n",
        Vec4ValuesFieldId, Vec4ValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleVec4Values),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleVec4Values));

    oType.addInitialDesc(pDesc);

    pDesc = new MFMatrix::Description(
        MFMatrix::getClassType(),
        "matrixValues",
        "The matrices.\n",
        MatrixValuesFieldId, MatrixValuesFieldMask,
        false,
        (Field::MFDefaultFlags | Field::FStdAccess),
        static_cast<FieldEditMethodSig>(&MultiPropertySSBOChunk::editHandleMatrixValues),
        static_cast<FieldGetMethodSig >(&MultiPropertySSBOChunk::getHandleMatrixValues));

    oType.addInitialDesc(pDesc);
}


MultiPropertySSBOChunkBase::TypeObject MultiPropertySSBOChunkBase::_type(
    MultiPropertySSBOChunkBase::getClassname(),
    Inherited::getClassname(),
    "NULL",
    nsOSG, //Namespace
    reinterpret_cast<PrototypeCreateF>(&MultiPropertySSBOChunkBase::createEmptyLocal),
    reinterpret_cast<InitContainerF>(&MultiPropertySSBOChunk::initMethod),
    reinterpret_cast<ExitContainerF>(&MultiPropertySSBOChunk::exitMethod),
    reinterpret_cast<InitalInsertDescFunc>(
        reinterpret_cast<void *>(&MultiPropertySSBOChunk::classDescInserter)),
    false,
    0,
    "<?xml version=\"1.0\"?>\n"
    "\n"
    "<FieldContainer\n"
    "    name=\"MultiPropertySSBOChunk\"\n"
    "    parent=\"ShaderStorageBufferObjStdLayoutChunk\"\n"
    "    library=\"System\"\n"
    "    pointerfieldtypes=\"both\"\n"
    "    structure=\"concrete\"\n"
    "    systemcomponent=\"true\"\n"
    "    parentsystemcomponent=\"true\"\n"
    "    decoratable=\"false\"\n"
    "    useLocalIncludes=\"false\"\n"
    "    docGroupBase=\"GrpSystemState\"\n"
    ">\n"
    "See \\ref PageSystemMultiPropertySSBOChunk for a description.\n"
    "\n"
    "The multi property chunk allows you to easily set up a shader storage block array with a simple \n"
    "plain struct layout in std430 buffer format.\n"
    "\n"
    "This chunk is basically a specialization of the ShaderStorageBufferObjStdLayoutChunk with a simpler \n"
    "usage pattern but at the cost of handling only a subset of the structural possibilities that the \n"
    "general chunk allows.\n"
    "\n"
    "It can for instance be perfectly used to define material databases. See the example 'multirangelight'\n"
    "in the simple example folder for an application of this chunk.\n"
    "\n"
    "    <Field\n"
    "        name=\"types\"\n"
    "        type=\"UInt8\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        Stores the type of a block entry. This can be any of the set {FLOAT_T, DOUBLE_T, INT_T, UINT_T, BOOL_T, VEC3_T, VEC4_T, MAT4_T}.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"cardinality\"\n"
    "        type=\"UInt32\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        Stores the cardinality types, i.e. the consecutive block layout members.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"cardinalities\"\n"
    "        type=\"UInt32\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        Stores the accumulated cardinalities for each type.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"numProperties\"\n"
    "        type=\"UInt32\"\n"
    "        cardinality=\"single\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        Stores the number of properties added to the chunk.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"floatValues\"\n"
    "        type=\"Real32\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The float values.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"doubleValues\"\n"
    "        type=\"Real64\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The double values.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"intValues\"\n"
    "        type=\"Int32\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The int values.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"uIntValues\"\n"
    "        type=\"UInt32\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The unsigned int values.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"boolValues\"\n"
    "        type=\"bool\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The bool values.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"vec3Values\"\n"
    "        type=\"Vec3f\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The 3D float vectors.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"vec4Values\"\n"
    "        type=\"Vec4f\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The 4D float vectors.\n"
    "    </Field>\n"
    "    <Field\n"
    "        name=\"matrixValues\"\n"
    "        type=\"Matrix\"\n"
    "        cardinality=\"multi\"\n"
    "        visibility=\"external\"\n"
    "        access=\"protected\"\n"
    "\t>\n"
    "        The matrices.\n"
    "    </Field>\n"
    "\n"
    "</FieldContainer>\n",
    "See \\ref PageSystemMultiPropertySSBOChunk for a description.\n"
    "\n"
    "The multi property chunk allows you to easily set up a shader storage block array with a simple \n"
    "plain struct layout in std430 buffer format.\n"
    "\n"
    "This chunk is basically a specialization of the ShaderStorageBufferObjStdLayoutChunk with a simpler \n"
    "usage pattern but at the cost of handling only a subset of the structural possibilities that the \n"
    "general chunk allows.\n"
    "\n"
    "It can for instance be perfectly used to define material databases. See the example 'multirangelight'\n"
    "in the simple example folder for an application of this chunk.\n"
    );

/*------------------------------ get -----------------------------------*/

FieldContainerType &MultiPropertySSBOChunkBase::getType(void)
{
    return _type;
}

const FieldContainerType &MultiPropertySSBOChunkBase::getType(void) const
{
    return _type;
}

UInt32 MultiPropertySSBOChunkBase::getContainerSize(void) const
{
    return sizeof(MultiPropertySSBOChunk);
}

/*------------------------- decorator get ------------------------------*/


MFUInt8 *MultiPropertySSBOChunkBase::editMFTypes(void)
{
    editMField(TypesFieldMask, _mfTypes);

    return &_mfTypes;
}

const MFUInt8 *MultiPropertySSBOChunkBase::getMFTypes(void) const
{
    return &_mfTypes;
}


MFUInt32 *MultiPropertySSBOChunkBase::editMFCardinality(void)
{
    editMField(CardinalityFieldMask, _mfCardinality);

    return &_mfCardinality;
}

const MFUInt32 *MultiPropertySSBOChunkBase::getMFCardinality(void) const
{
    return &_mfCardinality;
}


MFUInt32 *MultiPropertySSBOChunkBase::editMFCardinalities(void)
{
    editMField(CardinalitiesFieldMask, _mfCardinalities);

    return &_mfCardinalities;
}

const MFUInt32 *MultiPropertySSBOChunkBase::getMFCardinalities(void) const
{
    return &_mfCardinalities;
}


SFUInt32 *MultiPropertySSBOChunkBase::editSFNumProperties(void)
{
    editSField(NumPropertiesFieldMask);

    return &_sfNumProperties;
}

const SFUInt32 *MultiPropertySSBOChunkBase::getSFNumProperties(void) const
{
    return &_sfNumProperties;
}


MFReal32 *MultiPropertySSBOChunkBase::editMFFloatValues(void)
{
    editMField(FloatValuesFieldMask, _mfFloatValues);

    return &_mfFloatValues;
}

const MFReal32 *MultiPropertySSBOChunkBase::getMFFloatValues(void) const
{
    return &_mfFloatValues;
}


MFReal64 *MultiPropertySSBOChunkBase::editMFDoubleValues(void)
{
    editMField(DoubleValuesFieldMask, _mfDoubleValues);

    return &_mfDoubleValues;
}

const MFReal64 *MultiPropertySSBOChunkBase::getMFDoubleValues(void) const
{
    return &_mfDoubleValues;
}


MFInt32 *MultiPropertySSBOChunkBase::editMFIntValues(void)
{
    editMField(IntValuesFieldMask, _mfIntValues);

    return &_mfIntValues;
}

const MFInt32 *MultiPropertySSBOChunkBase::getMFIntValues(void) const
{
    return &_mfIntValues;
}


MFUInt32 *MultiPropertySSBOChunkBase::editMFUIntValues(void)
{
    editMField(UIntValuesFieldMask, _mfUIntValues);

    return &_mfUIntValues;
}

const MFUInt32 *MultiPropertySSBOChunkBase::getMFUIntValues(void) const
{
    return &_mfUIntValues;
}


MFBool *MultiPropertySSBOChunkBase::editMFBoolValues(void)
{
    editMField(BoolValuesFieldMask, _mfBoolValues);

    return &_mfBoolValues;
}

const MFBool *MultiPropertySSBOChunkBase::getMFBoolValues(void) const
{
    return &_mfBoolValues;
}


MFVec3f *MultiPropertySSBOChunkBase::editMFVec3Values(void)
{
    editMField(Vec3ValuesFieldMask, _mfVec3Values);

    return &_mfVec3Values;
}

const MFVec3f *MultiPropertySSBOChunkBase::getMFVec3Values(void) const
{
    return &_mfVec3Values;
}


MFVec4f *MultiPropertySSBOChunkBase::editMFVec4Values(void)
{
    editMField(Vec4ValuesFieldMask, _mfVec4Values);

    return &_mfVec4Values;
}

const MFVec4f *MultiPropertySSBOChunkBase::getMFVec4Values(void) const
{
    return &_mfVec4Values;
}


MFMatrix *MultiPropertySSBOChunkBase::editMFMatrixValues(void)
{
    editMField(MatrixValuesFieldMask, _mfMatrixValues);

    return &_mfMatrixValues;
}

const MFMatrix *MultiPropertySSBOChunkBase::getMFMatrixValues(void) const
{
    return &_mfMatrixValues;
}






/*------------------------------ access -----------------------------------*/

SizeT MultiPropertySSBOChunkBase::getBinSize(ConstFieldMaskArg whichField)
{
    SizeT returnValue = Inherited::getBinSize(whichField);

    if(FieldBits::NoField != (TypesFieldMask & whichField))
    {
        returnValue += _mfTypes.getBinSize();
    }
    if(FieldBits::NoField != (CardinalityFieldMask & whichField))
    {
        returnValue += _mfCardinality.getBinSize();
    }
    if(FieldBits::NoField != (CardinalitiesFieldMask & whichField))
    {
        returnValue += _mfCardinalities.getBinSize();
    }
    if(FieldBits::NoField != (NumPropertiesFieldMask & whichField))
    {
        returnValue += _sfNumProperties.getBinSize();
    }
    if(FieldBits::NoField != (FloatValuesFieldMask & whichField))
    {
        returnValue += _mfFloatValues.getBinSize();
    }
    if(FieldBits::NoField != (DoubleValuesFieldMask & whichField))
    {
        returnValue += _mfDoubleValues.getBinSize();
    }
    if(FieldBits::NoField != (IntValuesFieldMask & whichField))
    {
        returnValue += _mfIntValues.getBinSize();
    }
    if(FieldBits::NoField != (UIntValuesFieldMask & whichField))
    {
        returnValue += _mfUIntValues.getBinSize();
    }
    if(FieldBits::NoField != (BoolValuesFieldMask & whichField))
    {
        returnValue += _mfBoolValues.getBinSize();
    }
    if(FieldBits::NoField != (Vec3ValuesFieldMask & whichField))
    {
        returnValue += _mfVec3Values.getBinSize();
    }
    if(FieldBits::NoField != (Vec4ValuesFieldMask & whichField))
    {
        returnValue += _mfVec4Values.getBinSize();
    }
    if(FieldBits::NoField != (MatrixValuesFieldMask & whichField))
    {
        returnValue += _mfMatrixValues.getBinSize();
    }

    return returnValue;
}

void MultiPropertySSBOChunkBase::copyToBin(BinaryDataHandler &pMem,
                                  ConstFieldMaskArg  whichField)
{
    Inherited::copyToBin(pMem, whichField);

    if(FieldBits::NoField != (TypesFieldMask & whichField))
    {
        _mfTypes.copyToBin(pMem);
    }
    if(FieldBits::NoField != (CardinalityFieldMask & whichField))
    {
        _mfCardinality.copyToBin(pMem);
    }
    if(FieldBits::NoField != (CardinalitiesFieldMask & whichField))
    {
        _mfCardinalities.copyToBin(pMem);
    }
    if(FieldBits::NoField != (NumPropertiesFieldMask & whichField))
    {
        _sfNumProperties.copyToBin(pMem);
    }
    if(FieldBits::NoField != (FloatValuesFieldMask & whichField))
    {
        _mfFloatValues.copyToBin(pMem);
    }
    if(FieldBits::NoField != (DoubleValuesFieldMask & whichField))
    {
        _mfDoubleValues.copyToBin(pMem);
    }
    if(FieldBits::NoField != (IntValuesFieldMask & whichField))
    {
        _mfIntValues.copyToBin(pMem);
    }
    if(FieldBits::NoField != (UIntValuesFieldMask & whichField))
    {
        _mfUIntValues.copyToBin(pMem);
    }
    if(FieldBits::NoField != (BoolValuesFieldMask & whichField))
    {
        _mfBoolValues.copyToBin(pMem);
    }
    if(FieldBits::NoField != (Vec3ValuesFieldMask & whichField))
    {
        _mfVec3Values.copyToBin(pMem);
    }
    if(FieldBits::NoField != (Vec4ValuesFieldMask & whichField))
    {
        _mfVec4Values.copyToBin(pMem);
    }
    if(FieldBits::NoField != (MatrixValuesFieldMask & whichField))
    {
        _mfMatrixValues.copyToBin(pMem);
    }
}

void MultiPropertySSBOChunkBase::copyFromBin(BinaryDataHandler &pMem,
                                    ConstFieldMaskArg  whichField)
{
    Inherited::copyFromBin(pMem, whichField);

    if(FieldBits::NoField != (TypesFieldMask & whichField))
    {
        editMField(TypesFieldMask, _mfTypes);
        _mfTypes.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (CardinalityFieldMask & whichField))
    {
        editMField(CardinalityFieldMask, _mfCardinality);
        _mfCardinality.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (CardinalitiesFieldMask & whichField))
    {
        editMField(CardinalitiesFieldMask, _mfCardinalities);
        _mfCardinalities.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (NumPropertiesFieldMask & whichField))
    {
        editSField(NumPropertiesFieldMask);
        _sfNumProperties.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (FloatValuesFieldMask & whichField))
    {
        editMField(FloatValuesFieldMask, _mfFloatValues);
        _mfFloatValues.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (DoubleValuesFieldMask & whichField))
    {
        editMField(DoubleValuesFieldMask, _mfDoubleValues);
        _mfDoubleValues.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (IntValuesFieldMask & whichField))
    {
        editMField(IntValuesFieldMask, _mfIntValues);
        _mfIntValues.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (UIntValuesFieldMask & whichField))
    {
        editMField(UIntValuesFieldMask, _mfUIntValues);
        _mfUIntValues.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (BoolValuesFieldMask & whichField))
    {
        editMField(BoolValuesFieldMask, _mfBoolValues);
        _mfBoolValues.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (Vec3ValuesFieldMask & whichField))
    {
        editMField(Vec3ValuesFieldMask, _mfVec3Values);
        _mfVec3Values.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (Vec4ValuesFieldMask & whichField))
    {
        editMField(Vec4ValuesFieldMask, _mfVec4Values);
        _mfVec4Values.copyFromBin(pMem);
    }
    if(FieldBits::NoField != (MatrixValuesFieldMask & whichField))
    {
        editMField(MatrixValuesFieldMask, _mfMatrixValues);
        _mfMatrixValues.copyFromBin(pMem);
    }
}

//! create a new instance of the class
MultiPropertySSBOChunkTransitPtr MultiPropertySSBOChunkBase::createLocal(BitVector bFlags)
{
    MultiPropertySSBOChunkTransitPtr fc;

    if(getClassType().getPrototype() != NULL)
    {
        FieldContainerTransitPtr tmpPtr =
            getClassType().getPrototype()-> shallowCopyLocal(bFlags);

        fc = dynamic_pointer_cast<MultiPropertySSBOChunk>(tmpPtr);
    }

    return fc;
}

//! create a new instance of the class, copy the container flags
MultiPropertySSBOChunkTransitPtr MultiPropertySSBOChunkBase::createDependent(BitVector bFlags)
{
    MultiPropertySSBOChunkTransitPtr fc;

    if(getClassType().getPrototype() != NULL)
    {
        FieldContainerTransitPtr tmpPtr =
            getClassType().getPrototype()-> shallowCopyDependent(bFlags);

        fc = dynamic_pointer_cast<MultiPropertySSBOChunk>(tmpPtr);
    }

    return fc;
}

//! create a new instance of the class
MultiPropertySSBOChunkTransitPtr MultiPropertySSBOChunkBase::create(void)
{
    MultiPropertySSBOChunkTransitPtr fc;

    if(getClassType().getPrototype() != NULL)
    {
        FieldContainerTransitPtr tmpPtr =
            getClassType().getPrototype()-> shallowCopy();

        fc = dynamic_pointer_cast<MultiPropertySSBOChunk>(tmpPtr);
    }

    return fc;
}

MultiPropertySSBOChunk *MultiPropertySSBOChunkBase::createEmptyLocal(BitVector bFlags)
{
    MultiPropertySSBOChunk *returnValue;

    newPtr<MultiPropertySSBOChunk>(returnValue, bFlags);

    returnValue->_pFieldFlags->_bNamespaceMask &= ~bFlags;

    return returnValue;
}

//! create an empty new instance of the class, do not copy the prototype
MultiPropertySSBOChunk *MultiPropertySSBOChunkBase::createEmpty(void)
{
    MultiPropertySSBOChunk *returnValue;

    newPtr<MultiPropertySSBOChunk>(returnValue, Thread::getCurrentLocalFlags());

    returnValue->_pFieldFlags->_bNamespaceMask &=
        ~Thread::getCurrentLocalFlags();

    return returnValue;
}


FieldContainerTransitPtr MultiPropertySSBOChunkBase::shallowCopyLocal(
    BitVector bFlags) const
{
    MultiPropertySSBOChunk *tmpPtr;

    newPtr(tmpPtr, dynamic_cast<const MultiPropertySSBOChunk *>(this), bFlags);

    FieldContainerTransitPtr returnValue(tmpPtr);

    tmpPtr->_pFieldFlags->_bNamespaceMask &= ~bFlags;

    return returnValue;
}

FieldContainerTransitPtr MultiPropertySSBOChunkBase::shallowCopyDependent(
    BitVector bFlags) const
{
    MultiPropertySSBOChunk *tmpPtr;

    newPtr(tmpPtr, dynamic_cast<const MultiPropertySSBOChunk *>(this), ~bFlags);

    FieldContainerTransitPtr returnValue(tmpPtr);

    tmpPtr->_pFieldFlags->_bNamespaceMask = bFlags;

    return returnValue;
}

FieldContainerTransitPtr MultiPropertySSBOChunkBase::shallowCopy(void) const
{
    MultiPropertySSBOChunk *tmpPtr;

    newPtr(tmpPtr,
           dynamic_cast<const MultiPropertySSBOChunk *>(this),
           Thread::getCurrentLocalFlags());

    tmpPtr->_pFieldFlags->_bNamespaceMask &= ~Thread::getCurrentLocalFlags();

    FieldContainerTransitPtr returnValue(tmpPtr);

    return returnValue;
}




/*------------------------- constructors ----------------------------------*/

MultiPropertySSBOChunkBase::MultiPropertySSBOChunkBase(void) :
    Inherited(),
    _mfTypes                  (),
    _mfCardinality            (),
    _mfCardinalities          (),
    _sfNumProperties          (),
    _mfFloatValues            (),
    _mfDoubleValues           (),
    _mfIntValues              (),
    _mfUIntValues             (),
    _mfBoolValues             (),
    _mfVec3Values             (),
    _mfVec4Values             (),
    _mfMatrixValues           ()
{
}

MultiPropertySSBOChunkBase::MultiPropertySSBOChunkBase(const MultiPropertySSBOChunkBase &source) :
    Inherited(source),
    _mfTypes                  (source._mfTypes                  ),
    _mfCardinality            (source._mfCardinality            ),
    _mfCardinalities          (source._mfCardinalities          ),
    _sfNumProperties          (source._sfNumProperties          ),
    _mfFloatValues            (source._mfFloatValues            ),
    _mfDoubleValues           (source._mfDoubleValues           ),
    _mfIntValues              (source._mfIntValues              ),
    _mfUIntValues             (source._mfUIntValues             ),
    _mfBoolValues             (source._mfBoolValues             ),
    _mfVec3Values             (source._mfVec3Values             ),
    _mfVec4Values             (source._mfVec4Values             ),
    _mfMatrixValues           (source._mfMatrixValues           )
{
}


/*-------------------------- destructors ----------------------------------*/

MultiPropertySSBOChunkBase::~MultiPropertySSBOChunkBase(void)
{
}


GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleTypes           (void) const
{
    MFUInt8::GetHandlePtr returnValue(
        new  MFUInt8::GetHandle(
             &_mfTypes,
             this->getType().getFieldDesc(TypesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleTypes          (void)
{
    MFUInt8::EditHandlePtr returnValue(
        new  MFUInt8::EditHandle(
             &_mfTypes,
             this->getType().getFieldDesc(TypesFieldId),
             this));


    editMField(TypesFieldMask, _mfTypes);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleCardinality     (void) const
{
    MFUInt32::GetHandlePtr returnValue(
        new  MFUInt32::GetHandle(
             &_mfCardinality,
             this->getType().getFieldDesc(CardinalityFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleCardinality    (void)
{
    MFUInt32::EditHandlePtr returnValue(
        new  MFUInt32::EditHandle(
             &_mfCardinality,
             this->getType().getFieldDesc(CardinalityFieldId),
             this));


    editMField(CardinalityFieldMask, _mfCardinality);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleCardinalities   (void) const
{
    MFUInt32::GetHandlePtr returnValue(
        new  MFUInt32::GetHandle(
             &_mfCardinalities,
             this->getType().getFieldDesc(CardinalitiesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleCardinalities  (void)
{
    MFUInt32::EditHandlePtr returnValue(
        new  MFUInt32::EditHandle(
             &_mfCardinalities,
             this->getType().getFieldDesc(CardinalitiesFieldId),
             this));


    editMField(CardinalitiesFieldMask, _mfCardinalities);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleNumProperties   (void) const
{
    SFUInt32::GetHandlePtr returnValue(
        new  SFUInt32::GetHandle(
             &_sfNumProperties,
             this->getType().getFieldDesc(NumPropertiesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleNumProperties  (void)
{
    SFUInt32::EditHandlePtr returnValue(
        new  SFUInt32::EditHandle(
             &_sfNumProperties,
             this->getType().getFieldDesc(NumPropertiesFieldId),
             this));


    editSField(NumPropertiesFieldMask);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleFloatValues     (void) const
{
    MFReal32::GetHandlePtr returnValue(
        new  MFReal32::GetHandle(
             &_mfFloatValues,
             this->getType().getFieldDesc(FloatValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleFloatValues    (void)
{
    MFReal32::EditHandlePtr returnValue(
        new  MFReal32::EditHandle(
             &_mfFloatValues,
             this->getType().getFieldDesc(FloatValuesFieldId),
             this));


    editMField(FloatValuesFieldMask, _mfFloatValues);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleDoubleValues    (void) const
{
    MFReal64::GetHandlePtr returnValue(
        new  MFReal64::GetHandle(
             &_mfDoubleValues,
             this->getType().getFieldDesc(DoubleValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleDoubleValues   (void)
{
    MFReal64::EditHandlePtr returnValue(
        new  MFReal64::EditHandle(
             &_mfDoubleValues,
             this->getType().getFieldDesc(DoubleValuesFieldId),
             this));


    editMField(DoubleValuesFieldMask, _mfDoubleValues);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleIntValues       (void) const
{
    MFInt32::GetHandlePtr returnValue(
        new  MFInt32::GetHandle(
             &_mfIntValues,
             this->getType().getFieldDesc(IntValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleIntValues      (void)
{
    MFInt32::EditHandlePtr returnValue(
        new  MFInt32::EditHandle(
             &_mfIntValues,
             this->getType().getFieldDesc(IntValuesFieldId),
             this));


    editMField(IntValuesFieldMask, _mfIntValues);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleUIntValues      (void) const
{
    MFUInt32::GetHandlePtr returnValue(
        new  MFUInt32::GetHandle(
             &_mfUIntValues,
             this->getType().getFieldDesc(UIntValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleUIntValues     (void)
{
    MFUInt32::EditHandlePtr returnValue(
        new  MFUInt32::EditHandle(
             &_mfUIntValues,
             this->getType().getFieldDesc(UIntValuesFieldId),
             this));


    editMField(UIntValuesFieldMask, _mfUIntValues);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleBoolValues      (void) const
{
    MFBool::GetHandlePtr returnValue(
        new  MFBool::GetHandle(
             &_mfBoolValues,
             this->getType().getFieldDesc(BoolValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleBoolValues     (void)
{
    MFBool::EditHandlePtr returnValue(
        new  MFBool::EditHandle(
             &_mfBoolValues,
             this->getType().getFieldDesc(BoolValuesFieldId),
             this));


    editMField(BoolValuesFieldMask, _mfBoolValues);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleVec3Values      (void) const
{
    MFVec3f::GetHandlePtr returnValue(
        new  MFVec3f::GetHandle(
             &_mfVec3Values,
             this->getType().getFieldDesc(Vec3ValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleVec3Values     (void)
{
    MFVec3f::EditHandlePtr returnValue(
        new  MFVec3f::EditHandle(
             &_mfVec3Values,
             this->getType().getFieldDesc(Vec3ValuesFieldId),
             this));


    editMField(Vec3ValuesFieldMask, _mfVec3Values);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleVec4Values      (void) const
{
    MFVec4f::GetHandlePtr returnValue(
        new  MFVec4f::GetHandle(
             &_mfVec4Values,
             this->getType().getFieldDesc(Vec4ValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleVec4Values     (void)
{
    MFVec4f::EditHandlePtr returnValue(
        new  MFVec4f::EditHandle(
             &_mfVec4Values,
             this->getType().getFieldDesc(Vec4ValuesFieldId),
             this));


    editMField(Vec4ValuesFieldMask, _mfVec4Values);

    return returnValue;
}

GetFieldHandlePtr MultiPropertySSBOChunkBase::getHandleMatrixValues    (void) const
{
    MFMatrix::GetHandlePtr returnValue(
        new  MFMatrix::GetHandle(
             &_mfMatrixValues,
             this->getType().getFieldDesc(MatrixValuesFieldId),
             const_cast<MultiPropertySSBOChunkBase *>(this)));

    return returnValue;
}

EditFieldHandlePtr MultiPropertySSBOChunkBase::editHandleMatrixValues   (void)
{
    MFMatrix::EditHandlePtr returnValue(
        new  MFMatrix::EditHandle(
             &_mfMatrixValues,
             this->getType().getFieldDesc(MatrixValuesFieldId),
             this));


    editMField(MatrixValuesFieldMask, _mfMatrixValues);

    return returnValue;
}


#ifdef OSG_MT_CPTR_ASPECT
void MultiPropertySSBOChunkBase::execSyncV(      FieldContainer    &oFrom,
                                        ConstFieldMaskArg  whichField,
                                        AspectOffsetStore &oOffsets,
                                        ConstFieldMaskArg  syncMode,
                                  const UInt32             uiSyncInfo)
{
    MultiPropertySSBOChunk *pThis = static_cast<MultiPropertySSBOChunk *>(this);

    pThis->execSync(static_cast<MultiPropertySSBOChunk *>(&oFrom),
                    whichField,
                    oOffsets,
                    syncMode,
                    uiSyncInfo);
}
#endif


#ifdef OSG_MT_CPTR_ASPECT
FieldContainer *MultiPropertySSBOChunkBase::createAspectCopy(
    const FieldContainer *pRefAspect) const
{
    MultiPropertySSBOChunk *returnValue;

    newAspectCopy(returnValue,
                  dynamic_cast<const MultiPropertySSBOChunk *>(pRefAspect),
                  dynamic_cast<const MultiPropertySSBOChunk *>(this));

    return returnValue;
}
#endif

void MultiPropertySSBOChunkBase::resolveLinks(void)
{
    Inherited::resolveLinks();

#ifdef OSG_MT_CPTR_ASPECT
    AspectOffsetStore oOffsets;

    _pAspectStore->fillOffsetArray(oOffsets, this);
#endif

#ifdef OSG_MT_CPTR_ASPECT
    _mfTypes.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfCardinality.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfCardinalities.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfFloatValues.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfDoubleValues.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfIntValues.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfUIntValues.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfBoolValues.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfVec3Values.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfVec4Values.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
#ifdef OSG_MT_CPTR_ASPECT
    _mfMatrixValues.terminateShare(Thread::getCurrentAspect(),
                                      oOffsets);
#endif
}


OSG_END_NAMESPACE
