
MESSAGE(STATUS "")
MESSAGE(STATUS "processing OSGContribComputeBase support")

GET_FILENAME_COMPONENT(_CMAKE_CURRENT_LIST_DIR ${CMAKE_CURRENT_LIST_FILE} PATH)

#MESSAGE(STATUS "Prep osgcuda ${_CMAKE_CURRENT_LIST_DIR} ${CMAKE_CURRENT_LIST_FILE}")

SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${_CMAKE_CURRENT_LIST_DIR}/CMake")

IF(OSGNVidiaSDKSrcDir AND NOT OPENCL_INCLUDE_DIR)
  IF(EXISTS ${OSGNVidiaSDKSrcDir}/OpenCL/common/inc/CL/cl.h)
    SET(OPENCL_INCLUDE_DIR ${OSGNVidiaSDKSrcDir}/OpenCL/common/inc)
  ENDIF()
ENDIF()

FIND_PACKAGE(CUDA QUIET)
FIND_PACKAGE(OpenCL QUIET)
FIND_PACKAGE(OpenMP)

INCLUDE(CudaHelper)

OSG_SETUP_CUDA_FLAGS()

SET(CUDA_VERBOSE_BUILD ON)
SET(CUDA_BUILD_EMULATION OFF)

SET(OSG_SUPP_CC_BBASE Contrib)

IF(CUDA_FOUND)
  MESSAGE(STATUS "Using cuda version ${CUDA_VERSION}")

  ADD_SUBDIRECTORY("${_CMAKE_CURRENT_LIST_DIR}/Support/NVSdkCommon" ${OSG_SUPP_CC_BBASE}/NVSdkCommon)
  ADD_SUBDIRECTORY("${_CMAKE_CURRENT_LIST_DIR}/Support/CudaCommon"  ${OSG_SUPP_CC_BBASE}/CudaCommon)
#  ADD_SUBDIRECTORY("${_CMAKE_CURRENT_LIST_DIR}/Support/CudaUtil"    ${OSG_SUPP_CC_BBASE}/CudaUtil)

ENDIF(CUDA_FOUND)
